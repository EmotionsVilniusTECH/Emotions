# Project AFFECTS: Smart, Sensing, and Adaptive Buildings

This project is designed for the automated processing of emotional and biometric data (facial expressions and voice analysis). The system utilizes machine learning and statistical methods to identify user emotional states and detect anomalies within building environments.

---

## Modules & Output Data

### 1. Anomaly Detection (`Anomal_Detect.py`)
Applying an unsupervised machine learning method – the **One-Class SVM** algorithm – this module identifies atypical patterns in emotional indicators (such as arousal, anger, happiness, etc.) within time-series data.

* **Input:** A CSV file located in the `..\TEMP` directory (sourced from FaceReader and voice analysis devices).
* **Generated Files (Output):**
    * `[filename]_Cleaned.csv` – A "cleaned" dataset, filtered for regression analysis.
    * `[filename]_Anomalies.xlsx` – A detailed Excel report containing detected anomalies, timestamps, and visualizations.
    * `[filename]_Report.docx` / `.pdf` – A summarized visual report (PDF generation is supported on Windows only).
    * `[filename]_Archive.zip` – A compressed package containing all results.

**Execution:** `python Anomal_Detect.py [file_name_without_extension]`

---

### 2. Regression Analysis (`Regression.py`)
This module performs an in-depth statistical analysis using **OLS (Ordinary Least Squares)** regression to determine correlations between emotional variables and generates multi-language reports.

* **Input:** The cleaned data file generated by the first module (`_Cleaned.csv`).
* **Generated Files (Output):**
    * `[results_file].xlsx` – Calculation results (coefficients, p-values, standardized Beta) with embedded radar charts.
    * `Analysis_Report.pdf` – Final interpreted report in the selected language.
    * **Automated Notification:** The system automatically sends the results via email (recipient is determined based on file metadata).

**Execution:** `python Regression.py [data_file] [results_file] [language]`
* **Supported Languages:** `EN` (English), `IT` (Italian), `GE` (German), `FR` (French), `LT` (Lithuanian).

---

## Configuration & Environment

To ensure proper system functionality, the following conditions must be met:

1.  **Directory Structure:**
    * `..\TEMP\` – For input CSV files and intermediate results.
    * `..\DATA\` – For final regression reports.
    * `..\AUXIL\` – For auxiliary graphical assets (e.g., `Fonas1.png`).
2.  **Email Configuration:**
    * In `Regression.py`, within the `send_email_with_attachments` function, specify the sender's credentials (`sender_email`, `sender_password`).
    * *Note:* If using Gmail, it is highly recommended to use an **App Password**.
3.  **System Requirements:**
    * Converting Word documents to PDF requires **Microsoft Word** to be installed (Windows only).

---

## Security & Privacy

* **Local Processing:** All sensitive emotional data is processed locally on the user's machine to ensure privacy.
* **Credential Management:** Do not upload code containing plain-text email passwords to public repositories (e.g., GitHub). The use of environment variables is recommended.
* **Data Filtering:** Use a `.gitignore` file to prevent accidental disclosure of the `TEMP/` and `DATA/` directory contents.

---

![Result e-mail](Result_e_mail.png)
